# Tutorial Island - Part 5: Cooking Exit to Quest Guide
# STATUS: VALIDATED 2026-01-25
#
# This routine handles the navigation from the Cooking section to Quest Guide building.
# CRITICAL: The path from cooking exit requires going WEST first, then NORTH along western edge.
# Direct north paths are blocked by invisible fences.
#
# Previous section: 04_woodcutting_firemaking.yaml (ends with baking bread)
# Next section: 06_quest_guide.yaml (now merged into this file)

name: "Tutorial Island - Cooking to Quest Guide"
type: tutorial
phase: 5

# Key Locations (VALIDATED)
locations:
  cooking_exit_door: {x: 3072, y: 3090}    # Door to exit cooking building
  cooking_door_approach: {x: 3073, y: 3090}  # MUST walk here FIRST before opening door
  quest_guide_door: {x: 3086, y: 3126}
  quest_guide_npc: {x: 3084, y: 3121}
  ladder_down: {x: 3088, y: 3119}

# Navigation waypoints (VALIDATED - goes WEST first to avoid fences)
waypoints:
  - {x: 3073, y: 3090, note: "In front of cooking exit door"}
  - {x: 3072, y: 3100, note: "North along west edge"}
  - {x: 3072, y: 3110, note: "Continue north"}
  - {x: 3080, y: 3120, note: "Toward Quest Guide building"}
  - {x: 3086, y: 3125, note: "At Quest Guide door"}

widgets:
  quest_journal_tab: 35913794  # Opens quest journal

steps:
  # CRITICAL: Walk IN FRONT of door before trying to open it
  - id: 1
    description: "Walk to cooking exit door"
    action: GOTO
    args: "3073 3090 0"
    notes: |
      CRITICAL: Must be directly in front of door before INTERACT_OBJECT works.
      The door at (3072, 3090) leads OUT of the cooking building toward Quest Guide.
      Do NOT use the door closest to the cooking range - that leads backwards!

  - id: 2
    description: "Open cooking exit door"
    action: INTERACT_OBJECT
    args: "door Open"
    delay_before_ms: 1000

  - id: 3
    description: "Walk west then north - waypoint 1"
    action: GOTO
    args: "3072 3100 0"
    delay_before_ms: 1000
    notes: "Go WEST first to avoid invisible fences, then north"

  - id: 4
    description: "Continue north along west edge"
    action: GOTO
    args: "3072 3110 0"
    delay_before_ms: 1000

  - id: 5
    description: "Walk toward Quest Guide building"
    action: GOTO
    args: "3080 3120 0"
    delay_before_ms: 1000

  - id: 6
    description: "Walk to Quest Guide door"
    action: GOTO
    args: "3086 3125 0"
    delay_before_ms: 1000

  - id: 7
    description: "Open Quest Guide building door"
    action: INTERACT_OBJECT
    args: "door Open"
    delay_before_ms: 1000

  - id: 8
    description: "Talk to Quest Guide"
    action: INTERACT_NPC
    args: "Quest_Guide Talk-to"
    delay_before_ms: 2000

  - id: 9
    description: "Continue dialogue"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 2000

  - id: 10
    description: "Continue dialogue"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 11
    description: "Continue dialogue"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 12
    description: "Open Quest Journal tab"
    action: CLICK_WIDGET
    args: "35913794"
    delay_before_ms: 1000
    notes: "Tutorial says 'Click on the flashing icon to the left of your inventory'"

  - id: 13
    description: "Talk to Quest Guide again"
    action: INTERACT_NPC
    args: "Quest_Guide Talk-to"
    delay_before_ms: 2000

  - id: 14
    description: "Continue dialogue"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 2000

  - id: 15
    description: "Continue dialogue"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 16
    description: "Continue dialogue"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 17
    description: "Continue dialogue"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 18
    description: "Continue dialogue"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 19
    description: "Climb down ladder to mining section"
    action: INTERACT_OBJECT
    args: "Ladder Climb-down"
    delay_before_ms: 1000

# PITFALLS DISCOVERED (2026-01-25):
# 1. MUST walk IN FRONT of cooking exit door at (3073, 3090) before INTERACT_OBJECT works
# 2. The door closest to the cooking range leads BACKWARDS - use the one at (3072, 3090)
# 3. Direct north paths from cooking are blocked by invisible fences
# 4. Path must go WEST first (to ~3072 X), then north along western edge
# 5. Navigation via GOTO often fails - use incremental waypoints
# 6. Quest Guide dialogue has multiple "Click here to continue" screens
#
# After this routine:
# Player is underground in mining area at approximately (3088, 9520)
# Tutorial hint: "Mining and Smithing - Talk to the mining instructor"
# Ready for 07_mining_smithing.yaml
