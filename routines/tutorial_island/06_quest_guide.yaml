# Tutorial Island - Part 6: Quest Guide
# STATUS: VALIDATED
#
# This routine handles the Quest Guide section:
# 1. Navigate from Cooking area to Quest Guide building
# 2. Talk to Quest Guide
# 3. Open Quest Journal tab
# 4. Talk to Quest Guide again
# 5. Continue to mining section (ladder down)

name: "Tutorial Island - Quest Guide"
type: tutorial
phase: 6

steps:
  - id: 1
    description: "Walk to Quest Guide building area"
    action: GOTO
    args: "3086 3110 0"
    notes: "From cooking exit (3072, 3090), walk toward Quest Guide"

  - id: 2
    description: "Walk to Quest Guide building door"
    action: GOTO
    args: "3086 3126 0"
    delay_before_ms: 3000

  - id: 3
    description: "Open Quest Guide building door"
    action: INTERACT_OBJECT
    args: "Door Open"
    delay_before_ms: 2000

  - id: 4
    description: "Talk to Quest Guide"
    action: INTERACT_NPC
    args: "Quest_Guide Talk-to"
    delay_before_ms: 2000

  - id: 5
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 2000

  - id: 6
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 7
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 8
    description: "Open Quest Journal tab"
    action: CLICK_WIDGET
    args: "35913794"
    delay_before_ms: 1000
    notes: |
      Widget ID: 35913794 = (548 << 16) | 66
      CLICK_WIDGET only takes widget ID, not action strings

  - id: 9
    description: "Click Quest Guide dialogue option"
    action: CLICK_WIDGET
    args: "15138820"
    delay_before_ms: 2000
    notes: |
      CRITICAL: After opening Quest tab, a dialogue appears with options:
      - "Quest Guide" (widget 15138820)
      - "Click here to continue"
      Must click "Quest Guide" option to proceed.

  - id: 10
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 11
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 12
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 13
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 14
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 15
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 16
    description: "Climb down ladder to mining section"
    action: INTERACT_OBJECT
    args: "Ladder Climb-down"
    delay_before_ms: 1000
    notes: |
      Ladder leads to underground mining tutorial area.

# PITFALLS DISCOVERED:
# 1. CLICK_WIDGET only takes widget ID - not action strings
# 2. CLICK_CONTINUE doesn't exist - use KEY_PRESS Space
# 3. await_condition and repeat_until cause timeouts - removed
# 4. CRITICAL: After opening Quest tab, a dialogue with options appears:
#    - Must click "Quest Guide" option (widget 15138820) NOT "Click here to continue"
#    - Only after completing this dialogue does the ladder become usable
#    - Check tutorial hint (widget group 263) to verify progress

# After this routine:
# Player in underground area, ready for 07_mining_smithing.yaml
