# Tutorial Island - Part 7: Mining & Smithing
# STATUS: VALIDATED
#
# This routine handles the Mining & Smithing section:
# 1. Talk to Mining Instructor
# 2. Prospect tin and copper rocks
# 3. Mine tin ore
# 4. Mine copper ore
# 5. Smelt bronze bar at furnace
# 6. Smith bronze dagger at anvil
# 7. Continue to combat section

name: "Tutorial Island - Mining & Smithing"
type: tutorial
phase: 7

# Key NPCs
npcs:
  mining_instructor:
    name: "Mining Instructor"
    id: 3311
    location: {x: 3080, y: 9502, plane: 0}
    action: "Talk-to"

# Key Objects (estimated - need validation)
objects:
  tin_rocks:
    name: "Rocks"  # Contains tin
    location: {x: 3076, y: 9504, plane: 0}  # Approximate
  copper_rocks:
    name: "Rocks"  # Contains copper
    location: {x: 3085, y: 9502, plane: 0}  # Approximate
  furnace:
    name: "Furnace"
    location: {x: 3079, y: 9496, plane: 0}  # Approximate
  anvil:
    name: "Anvil"
    location: {x: 3083, y: 9499, plane: 0}  # Approximate

# Key Widgets
widgets:
  continue_button: 12648448  # or use find_and_click_widget(text="Continue")

steps:
  - id: 1
    description: "Walk to Mining Instructor"
    action: GOTO
    args: "3080 9504 0"
    validated: true
    notes: "From ladder at (3088, 9520), walk south to mining area"

  - id: 2
    description: "Talk to Mining Instructor"
    action: INTERACT_NPC
    args: "Mining_Instructor Talk-to"
    delay_before_ms: 2000

  - id: 3
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 2000

  - id: 4
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 5
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 6
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000
    notes: "Instructor introduces mining. Gives you a bronze pickaxe."

  - id: 7
    description: "Prospect tin rocks"
    action: INTERACT_OBJECT
    args: "Rocks Prospect"
    delay_before_ms: 2000
    notes: "Click on bluish rocks to prospect for tin"

  - id: 8
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 3000

  - id: 9
    description: "Mine tin ore"
    action: INTERACT_OBJECT
    args: "Rocks Mine"
    delay_before_ms: 1000

  - id: 10
    description: "Wait for mining to complete"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 5000

  - id: 11
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 2000

  - id: 12
    description: "Prospect copper rocks"
    action: INTERACT_OBJECT
    args: "Rocks Prospect"
    delay_before_ms: 1000
    notes: "Brown/orange rocks contain copper"

  - id: 13
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 3000

  - id: 14
    description: "Mine copper ore"
    action: INTERACT_OBJECT
    args: "Rocks Mine"
    delay_before_ms: 1000

  - id: 15
    description: "Wait for mining to complete"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 5000

  - id: 16
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 2000

  - id: 17
    description: "Smelt bronze bar at furnace"
    action: USE_ITEM_ON_OBJECT
    args: "tin Furnace"
    delay_before_ms: 2000
    notes: "Use partial item name 'tin' like in cooking section"

  - id: 18
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 3000

  - id: 19
    description: "Talk to Mining Instructor about smithing"
    action: INTERACT_NPC
    args: "Mining_Instructor Talk-to"
    delay_before_ms: 2000

  - id: 20
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 2000

  - id: 21
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 22
    description: "Continue dialogue (space)"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 1000

  - id: 23
    description: "Smith bronze dagger at anvil"
    action: USE_ITEM_ON_OBJECT
    args: "bronze Anvil"
    delay_before_ms: 2000
    notes: "May need to select dagger from smithing interface"

  - id: 24
    description: "Continue dialogue (space) after smithing"
    action: KEY_PRESS
    args: "Space"
    delay_before_ms: 3000

  - id: 25
    description: "Continue to combat section - open gate"
    action: INTERACT_OBJECT
    args: "Gate Open"
    delay_before_ms: 1000
    notes: "Gate leads east to combat training area"

# VALIDATED SO FAR:
# - GOTO 3080 9504 0  # Navigate to Mining Instructor
# - INTERACT_NPC Mining_Instructor Talk-to
# - find_and_click_widget(text="Continue") works for dialogue

# PITFALLS TO WATCH FOR:
# 1. Multiple rock types - need to identify tin vs copper by appearance
# 2. May need to prospect rocks before mining (Tutorial requirement)
# 3. Smithing interface may require widget interaction to select dagger
# 4. USE_ITEM_ON_OBJECT should work with partial names (like cooking)

# SESSION BLOCKED:
# Account 'aux' exceeded 12hr playtime limit at this point.
# Resume validation when playtime resets.
