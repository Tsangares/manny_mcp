# Cooking Routine - Lumbridge Castle Range
# Cooks raw fish at the Lumbridge Castle kitchen range
# UPDATED: 2025-01-11 - Uses Bottom-floor/Top-floor to skip middle floor
# CRITICAL: Use SOUTHERN staircase only! Northern leads to complex indoor navigation.

name: "Cooking at Lumbridge Range"
description: "Cook raw fish at Lumbridge Castle range, banking on top floor"
type: "skilling"
skill: "cooking"

# Configuration - change these for different foods
config:
  raw_food: "Raw lobster"        # What to withdraw (use spaces for items)
  cooked_food: "Lobster"         # Expected cooked result
  quantity: 28                   # Full inventory (was 27)

requirements:
  items:
    - name: "Raw lobster"
      quantity: 28
      note: "Or Raw shrimps, Raw anchovies, etc."
  locations:
    - name: "Lumbridge Castle"
      note: "Bank on plane 2, Range on plane 0"

# CRITICAL LOCATIONS - Use southern stairwell exclusively!
locations:
  lumbridge_bank:
    x: 3208
    y: 3220
    plane: 2
    description: "Lumbridge Castle bank (top floor)"

  cooking_range:
    x: 3211
    y: 3215
    plane: 0
    description: "Lumbridge Castle kitchen - Cooking range"

  southern_staircase_ground:
    x: 3206
    y: 3208
    plane: 0
    description: "SOUTHERN staircase - ground floor (USE THIS ONE!)"

  southern_staircase_top:
    x: 3205
    y: 3209
    plane: 2
    description: "SOUTHERN staircase - top floor (near bank)"

# Step-by-step routine
steps:
  # ========== PHASE 1: BANK - WITHDRAW RAW FOOD ==========
  - id: 1
    phase: "banking"
    action: BANK_OPEN
    description: "Open bank interface"
    notes: "Must be near banker NPC on plane 2"

  - id: 2
    phase: "banking"
    action: BANK_WITHDRAW
    args: "Raw lobster 28"
    description: "Withdraw raw fish to cook"
    await_condition: "has_item:Raw lobster"
    notes: "Item names use SPACES: 'Raw lobster' not 'Raw_lobster'"

  - id: 3
    phase: "banking"
    action: BANK_CLOSE
    description: "Close bank interface"

  # ========== PHASE 2: NAVIGATE DOWN (BOTTOM-FLOOR SKIPS MIDDLE) ==========
  - id: 4
    phase: "navigate_down"
    action: GOTO
    args: "3205 3209 2"
    description: "Walk to southern staircase"
    await_condition: "location:3205,3209"
    timeout_ms: 15000
    notes: "GOTO before interacting increases reliability"

  - id: 5
    phase: "navigate_down"
    action: INTERACT_OBJECT
    args: "Staircase Bottom-floor"
    description: "Use Bottom-floor to skip directly to plane 0"
    await_condition: "plane:0"
    timeout_ms: 15000
    notes: "Bottom-floor skips the middle floor (plane 1) - much faster!"

  # ========== PHASE 3: COOK ==========
  - id: 6
    phase: "cooking"
    action: GOTO
    args: "3211 3215 0"
    description: "Walk to Range"
    await_condition: "location:3211,3215"
    timeout_ms: 10000
    notes: "GOTO before interacting with Range"

  - id: 7
    phase: "cooking"
    action: INTERACT_OBJECT
    args: "Range Cook"
    description: "Click on Range to open cooking interface"
    delay_after_ms: 2000
    notes: "Object name is 'Range' - opens cooking interface"

  - id: 8
    phase: "cooking"
    action: KEY_PRESS
    args: "Space"
    description: "Press Space to start cooking all"
    notes: "Space confirms 'Cook All' in the interface"

  - id: 9
    phase: "cooking"
    action: WAIT
    await_condition: "no_item:Raw lobster"
    timeout_ms: 90000
    description: "Wait for cooking to complete"
    notes: |
      Cooking 28 lobsters takes ~60-70 seconds.
      Level-up dialogues are auto-dismissed by LevelUpHandler.

  # ========== PHASE 4: NAVIGATE UP (TOP-FLOOR SKIPS MIDDLE) ==========
  - id: 10
    phase: "navigate_up"
    action: GOTO
    args: "3206 3208 0"
    description: "Walk to southern staircase"
    await_condition: "location:3206,3208"
    timeout_ms: 10000
    notes: "GOTO before interacting with staircase"

  - id: 11
    phase: "navigate_up"
    action: INTERACT_OBJECT
    args: "Staircase Top-floor"
    description: "Use Top-floor to skip directly to plane 2"
    await_condition: "plane:2"
    timeout_ms: 15000
    notes: "Top-floor skips the middle floor (plane 1) - much faster!"

  - id: 12
    phase: "navigate_up"
    action: GOTO
    args: "3208 3220 2"
    description: "Walk back to bank area"
    await_condition: "location:3208,3220"
    timeout_ms: 10000

  # ========== PHASE 5: DEPOSIT AND REPEAT ==========
  - id: 13
    phase: "deposit"
    action: BANK_OPEN
    description: "Open bank to deposit cooked food"

  - id: 14
    phase: "deposit"
    action: BANK_DEPOSIT_ALL
    description: "Deposit all cooked fish and burnt fish"
    notes: "Deposits Lobster, Burnt lobster, and any other items"

  - id: 15
    phase: "deposit"
    action: BANK_CLOSE
    description: "Close bank before next trip"

  # Loop back to step 1 for next trip

# Execution notes from ACTUAL TESTING
notes: |
  UPDATED: 2025-01-11
  Successfully cooking Raw lobster at level 45
  Burn rate at level 45: ~25%

  KEY OPTIMIZATIONS:

  1. BOTTOM-FLOOR / TOP-FLOOR:
     - Use "Bottom-floor" from plane 2 to skip directly to plane 0
     - Use "Top-floor" from plane 0 to skip directly to plane 2
     - Saves ~5 seconds per trip by skipping middle floor!

  2. GOTO BEFORE INTERACT:
     - Always GOTO near an object before INTERACT_OBJECT
     - Increases reliability of staircase interactions
     - Prevents "object not found" errors

  3. FULL INVENTORY (28):
     - Use 28 slots instead of 27 for max efficiency

  4. KEY_PRESS SPACE:
     - Use KEY_PRESS Space instead of clicking widgets
     - More reliable than CLICK_WIDGET for cooking interface

  5. STAIRCASE ACTIONS:
     From plane 2 (top): "Bottom-floor" -> plane 0
     From plane 0 (ground): "Top-floor" -> plane 2
     Middle floor (plane 1): Only "Climb-up" / "Climb-down" available

  To change fish type:
  - Step 2 args: "Raw shrimps 28"
  - Step 9 await_condition: "no_item:Raw shrimps"

  Expected results for lobster:
  - XP per lobster: 120 (cooked) or 0 (burnt)
  - Burn rate at level 45: ~25%
  - Trip time: ~2 minutes with Bottom-floor/Top-floor optimization

# Loop configuration
loop:
  enabled: true
  repeat_from_step: 1
  stop_conditions:
    - "no_item_in_bank:Raw lobster"
    - "cooking_level:99"
